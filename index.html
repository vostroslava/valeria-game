<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Valeria Q&A</title>

    <style>
        :root {
            --bg-gradient: radial-gradient(circle at 0% 0%, #ffb6c9 0, transparent 55%),
                           radial-gradient(circle at 100% 0%, #ffc46b 0, transparent 55%),
                           radial-gradient(circle at 100% 100%, #8ec5fc 0, transparent 55%),
                           radial-gradient(circle at 0% 100%, #e0c3fc 0, transparent 55%),
                           #050816;
            --card-bg: rgba(9, 10, 22, 0.92);
            --accent: #ff7ac4;
            --accent-soft: rgba(255, 122, 196, 0.18);
            --text-main: #f9f9ff;
            --text-muted: #b2b2d6;
            --border-subtle: rgba(255, 255, 255, 0.08);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", system-ui, Roboto, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: stretch;
            padding: 18px 14px;
        }

        .frame {
            width: 100%;
            max-width: 460px;
            border-radius: 28px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: radial-gradient(circle at 0 0, rgba(255,255,255,0.09) 0, transparent 55%),
                        radial-gradient(circle at 100% 100%, rgba(0,0,0,0.5) 0, transparent 55%),
                        rgba(6, 6, 18, 0.92);
            backdrop-filter: blur(18px);
            box-shadow:
                0 24px 60px rgba(0, 0, 0, 0.7),
                0 0 0 1px rgba(255, 255, 255, 0.02);
        }

        header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 12px;
        }

        .avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-image: linear-gradient(135deg, #ff9a9e, #fecfef);
            padding: 2px;
            position: relative;
            box-shadow: 0 0 0 1px rgba(0,0,0,0.6);
            flex-shrink: 0;
        }

        .avatar-inner {
            width: 100%;
            height: 100%;
            border-radius: inherit;
            background: url('https://images.pexels.com/photos/167636/pexels-photo-167636.jpeg?auto=compress&cs=tinysrgb&w=400') center/cover no-repeat;
            filter: saturate(1.1);
        }

        .live-pill {
            position: absolute;
            right: -4px;
            bottom: -4px;
            background: linear-gradient(135deg, #ff3b6b, #ff9a62);
            color: #fff;
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 999px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            box-shadow: 0 0 0 2px #050816;
        }

        header h1 {
            font-size: 21px;
            margin: 0 0 4px;
            letter-spacing: 0.02em;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        header h1 span.mic {
            font-size: 18px;
        }

        header p {
            margin: 0;
            font-size: 13px;
            color: var(--text-muted);
        }

        .chip-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .chip {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            border: 1px solid rgba(255, 255, 255, 0.14);
            color: var(--text-muted);
            background: radial-gradient(circle at 0 0, rgba(255,255,255,0.08) 0, transparent 60%);
        }

        .chip--accent {
            border-color: rgba(255, 122, 196, 0.6);
            color: #ffe2f5;
            background: radial-gradient(circle at 0 0, rgba(255,122,196,0.25) 0, transparent 60%);
        }

       /* –ë–ª–æ–∫ –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ */
.modes-block {
    margin: 10px 0 16px;
    padding: 10px 12px 12px;
    border-radius: 18px;
    background:
        radial-gradient(circle at 0 0, rgba(255,122,196,0.18) 0, transparent 60%),
        rgba(8, 8, 24, 0.96);
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 0 16px 30px rgba(0,0,0,0.65);
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–∞–¥ –∫–Ω–æ–ø–∫–∞–º–∏ */
.modes-title {
    font-size: 12px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 8px;
}

/* –†—è–¥ –∫–Ω–æ–ø–æ–∫ —É—Ä–æ–≤–Ω–µ–π */
.modes {
    display: flex;
    gap: 8px;
}

/* –û–±—ä—ë–º–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —É—Ä–æ–≤–Ω–µ–π ‚Äî –∫—Ä—É–ø–Ω–µ–µ –∏ 3D */
.mode-btn {
    flex: 1;
    padding: 10px 0;
    border-radius: 999px;
    font-size: 13px;
    font-weight: 600;
    border: 1px solid rgba(255,255,255,0.18);
    background: radial-gradient(circle at 0 0, rgba(255,255,255,0.08) 0, transparent 60%),
                linear-gradient(145deg, rgba(20,20,40,0.98), rgba(10,10,26,1));
    color: var(--text-muted);
    cursor: pointer;
    box-shadow:
        0 10px 22px rgba(0,0,0,0.8),
        0 0 0 1px rgba(0,0,0,0.6);
    transform: translateZ(0);
    transition:
        transform 0.13s ease,
        box-shadow 0.15s ease,
        background 0.15s ease,
        border-color 0.15s ease,
        color 0.15s ease;
    white-space: nowrap;
}

.mode-btn:hover {
    transform: translateY(-1px);
    box-shadow:
        0 14px 30px rgba(0,0,0,0.9),
        0 0 0 1px rgba(0,0,0,0.7);
    background: radial-gradient(circle at 0 0, rgba(255,255,255,0.1) 0, transparent 60%),
                linear-gradient(145deg, rgba(30,30,60,1), rgba(12,12,30,1));
}

/* –ê–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —É—Ä–æ–≤–Ω—è ‚Äî –∑–∞–º–µ—Ç–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ */
.mode-btn--active {
    border-color: rgba(255,122,196,0.9);
    color: #1b0614;
    background:
        radial-gradient(circle at 0 0, rgba(255,255,255,0.18) 0, transparent 60%),
        linear-gradient(135deg, #ff7ac4, #ffb86b);
    box-shadow:
        0 16px 34px rgba(0,0,0,0.95),
        0 0 22px rgba(255,122,196,0.9);
}

/* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö ‚Äî —á—É—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ, –Ω–æ –≤—Å—ë –µ—â—ë –æ–±—ä—ë–º–Ω–æ */
@media (max-width: 480px) {
    .modes-block {
        padding: 9px 10px 10px;
        margin: 8px 0 14px;
    }
    .mode-btn {
        font-size: 12px;
        padding: 9px 0;
    }
}
        .card {
            margin-top: 6px;
            padding: 18px 16px 16px;
            border-radius: 22px;
            background: radial-gradient(circle at 0 0, rgba(255,255,255,0.04) 0, transparent 60%),
                        radial-gradient(circle at 100% 100%, rgba(255,255,255,0.02) 0, transparent 60%),
                        var(--card-bg);
            border: 1px solid var(--border-subtle);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: "";
            position: absolute;
            inset: 0;
            background:
              radial-gradient(circle at 0 0, rgba(255, 255, 255, 0.06) 0, transparent 55%),
              radial-gradient(circle at 100% 0, rgba(255, 122, 196, 0.08) 0, transparent 55%);
            opacity: 0.8;
            pointer-events: none;
        }

        .card-inner {
            position: relative;
            z-index: 1;
        }

        .label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--text-muted);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .label-dot {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: #3cffb5;
            box-shadow: 0 0 0 4px rgba(60, 255, 181, 0.12);
        }

        .question-box {
            padding: 12px 10px 6px;
            font-size: 17px;
            line-height: 1.45;
            color: #fdfdff;
        }

        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 4px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .topic-pill {
            padding: 3px 9px;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.12);
        }

        textarea {
            width: 100%;
            margin-top: 14px;
            padding: 12px 12px;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.18);
            background: rgba(4, 7, 22, 0.9);
            color: var(--text-main);
            font-size: 14px;
            resize: none;
            min-height: 110px;
            outline: none;
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.7);
        }

        textarea::placeholder {
            color: #66688b;
        }

        .btn-row {
            display: grid;
            grid-template-columns: 1.15fr 0.95fr;
            gap: 10px;
            margin-top: 16px;
        }

        button {
            border-radius: 999px;
            padding: 12px 14px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: transform 0.11s ease, box-shadow 0.16s ease, background 0.16s ease, opacity 0.16s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            white-space: nowrap;
        }

        button:active {
            transform: translateY(1px) scale(0.99);
            box-shadow: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ff7ac4, #ffb86b);
            color: #1b0614;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.6);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.03);
            color: #f1e6ff;
            border: 1px solid rgba(255,255,255,0.18);
        }

        .btn-secondary span.dice {
            font-size: 16px;
        }

        .small-note {
            text-align: center;
            margin-top: 14px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .small-note span {
            color: var(--accent);
        }

        .toast {
            position: fixed;
            left: 50%;
            bottom: 22px;
            transform: translateX(-50%);
            padding: 10px 16px;
            border-radius: 999px;
            background: rgba(12, 14, 32, 0.96);
            color: #f6f2ff;
            font-size: 13px;
            display: none;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255,255,255,0.16);
            box-shadow: 0 15px 40px rgba(0,0,0,0.7);
            z-index: 20;
        }

        .toast-dot {
            width: 9px;
            height: 9px;
            border-radius: 50%;
            background: #34c759;
            box-shadow: 0 0 0 5px rgba(52, 199, 89, 0.22);
        }

        @media (max-width: 480px) {
            body {
                padding: 16px 10px;
            }
            .frame {
                padding: 16px 14px 18px;
                border-radius: 24px;
            }
            .btn-row {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>

<body>
<div class="frame">
    <header>
        <div class="avatar">
            <div class="avatar-inner"></div>
            <div class="live-pill">live</div>
        </div>
        <div>
            <h1><span class="mic">üéô</span>–í–æ–ø—Ä–æ—Å –¥–ª—è –í–∞–ª–µ—Ä–∏–∏</h1>
            <p>–ù–µ–±–æ–ª—å—à–∞—è –ª–∏—á–Ω–∞—è —Å—Ü–µ–Ω–∞, –≥–¥–µ –º–æ–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å —Ç–∞–∫, –∫–∞–∫ –∑–≤—É—á–∏—Ç —Ç–≤–æ–π –≥–æ–ª–æ—Å –≤–Ω—É—Ç—Ä–∏.</p>
        </div>
    </header>

    <div class="chip-row">
    <div class="chip chip--accent">Singer ¬∑ Live</div>
    <div class="chip">Soul talk</div>
    <div class="chip">1&nbsp;–≤–æ–ø—Ä–æ—Å –∑–∞ —Ä–∞–∑</div>
</div>

<div class="modes-block">
    <div class="modes-title">–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å –≤–æ–ø—Ä–æ—Å–∞</div>
    <div class="modes">
        <button class="mode-btn mode-btn--active" data-level="light" onclick="setLevel('light')">
            –õ–µ–≥–∫–æ
        </button>
        <button class="mode-btn" data-level="warm" onclick="setLevel('warm')">
            –¢–µ–ø–ª–æ
        </button>
        <button class="mode-btn" data-level="deep" onclick="setLevel('deep')">
            –ì–ª—É–±–∂–µ
        </button>
    </div>
</div>


    <section class="card">
        <div class="card-inner">
            <div class="label"><span class="label-dot"></span>–í–æ–ø—Ä–æ—Å –¥–Ω—è</div>
            <div id="questionBox" class="question-box">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞...</div>
            <div class="question-meta">
                <div id="topicPill" class="topic-pill">–¢–µ–º–∞: ‚Äî</div>
                <div>–°–ª—É—á–∞–π–Ω—ã–π –≤–æ–ø—Ä–æ—Å</div>
            </div>

            <textarea id="answerInput" placeholder="–ú–æ–∂–Ω–æ –∫–æ—Ä–æ—Ç–∫–æ, –º–æ–∂–Ω–æ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ ‚Äî –∫–∞–∫ —Ç–µ–±–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ."></textarea>

            <div class="btn-row">
                <button class="btn-primary" onclick="sendAnswer()">
                    <span>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç</span>
                    <span>‚û§</span>
                </button>
                <button class="btn-secondary" onclick="loadNewQuestion()">
                    <span class="dice">üé≤</span>
                    <span>–î—Ä—É–≥–æ–π –≤–æ–ø—Ä–æ—Å</span>
                </button>
            </div>

            <div class="small-note">
                –û—Ç–≤–µ—Ç —É—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ <span>–°–ª–∞–≤–µ</span>. –ù–∏–∫–∞–∫–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π, —Ç–æ–ª—å–∫–æ –ª–∏—á–Ω—ã–π –¥–∏–∞–ª–æ–≥.
            </div>
        </div>
    </section>
</div>

<div id="toast" class="toast">
    <div class="toast-dot"></div>
    <div id="toastText">–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.</div>
</div>
<script>
const SHEET_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvKeCKWOgUi4D4dUTbISt-3bMK3B1QpmqJapgJfFRtpBOkwdrxR_uOU5JJrqltGFFgA0qZxSgJPnb/pub?gid=0&single=true&output=csv";

const webhookUrl =
  "https://script.google.com/macros/s/AKfycbwGsYzw4o31i9AzDo-kG832v1CtOnWpm8YH-Xvti5sG7_p9-99O27U7sqkqdWzI3nowmQ/exec";

const levelMap = {
  "1": "light",
  "2": "warm",
  "3": "deep",
  light: "light",
  warm: "warm",
  deep: "deep"
};

let questions = [];
let currentQuestion = null;
let currentLevel = "light";

const el = {
  box: document.getElementById("questionBox"),
  topic: document.getElementById("topicPill"),
  answer: document.getElementById("answerInput"),
  toast: document.getElementById("toast"),
  toastText: document.getElementById("toastText"),
};

/* –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π CSV-–ø–∞—Ä—Å–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∞–≤—ã—á–µ–∫ */
function parseCSV(csv) {
  return csv
    .trim()
    .split("\n")
    .map(line => line.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g).map(v => v.replace(/^"|"$/g, "")));
}

/* –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ */
async function loadQuestionsFromSheet() {
  try {
    const csv = await (await fetch(SHEET_URL)).text();
    const rows = parseCSV(csv);
    const headers = rows.shift().map(h => h.trim());

    questions = rows
      .map(values =>
        Object.fromEntries(headers.map((k, i) => [k, values[i] || ""]))
      )
      .filter(q => {
        const v = q.active?.toLowerCase();
        return !v || v === "true" || v === "1" || v === "–∏—Å—Ç–∏–Ω–∞";
      })
      .map(q => ({
        id: q.id,
        text: q.question,
        topic: q.topic,
        level: levelMap[q.level?.toLowerCase()] || "light"
      }));

    if (!questions.length) {
      el.box.textContent = "–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤. –ü—Ä–æ–≤–µ—Ä—å —Ç–∞–±–ª–∏—Ü—É.";
      el.topic.textContent = "–¢–µ–º–∞: ‚Äî";
    }
  } catch (e) {
    console.error(e);
    el.box.textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ–ø—Ä–æ—Å–æ–≤.";
  }
}

/* –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ */
function loadNewQuestion() {
  if (!questions.length) {
    el.box.textContent = "–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.";
    el.topic.textContent = "–¢–µ–º–∞: ‚Äî";
    return (currentQuestion = null);
  }

  const pool = questions.filter(q => q.level === currentLevel);
  const source = pool.length ? pool : questions;

  currentQuestion = source[Math.floor(Math.random() * source.length)];

  el.box.textContent = currentQuestion.text || "–ü—É—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å";
  el.topic.textContent = "–¢–µ–º–∞: " + (currentQuestion.topic || "‚Äî");
}

/* –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è */
function setLevel(level) {
  currentLevel = level;
  document
    .querySelectorAll(".mode-btn")
    .forEach(b => b.classList.toggle("mode-btn--active", b.dataset.level === level));

  loadNewQuestion();
}

/* Toast */
function showToast(message) {
  el.toastText.textContent = message;
  el.toast.style.display = "flex";
  setTimeout(() => (el.toast.style.display = "none"), 2000);
}

/* –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ */
function sendAnswer() {
  const answer = el.answer.value.trim();

  if (!answer) return showToast("–ù–∞–ø–∏—à–∏ —Ö–æ—Ç—è –±—ã –ø–∞—Ä—É —Å–ª–æ–≤.");
  if (!currentQuestion) return showToast("–í–æ–ø—Ä–æ—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è.");

  fetch(webhookUrl, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "text/plain;charset=utf-8" },
    body: JSON.stringify({
      questionText: currentQuestion.text,
      topic: currentQuestion.topic,
      answer,
      who: "Valeria",
    }),
  }).then(() => {
    el.answer.value = "";
    loadNewQuestion();
    showToast("–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω ‚Äî —Å–ø–∞—Å–∏–±–æ.");
  });
}

document.addEventListener("DOMContentLoaded", async () => {
  await loadQuestionsFromSheet();
  loadNewQuestion();
});
</script>

</body>
</html>
